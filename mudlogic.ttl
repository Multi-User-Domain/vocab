@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix ldp: <http://www.w3.org/ns/ldp#> .
@prefix schema: <http://schema.org/> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix time: <http://www.w3.org/2006/time#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix mud: <https://raw.githubusercontent.com/Multi-User-Domain/vocab/main/mud.ttl#> .

@prefix mudlogic: <#> .

mudlogic: rdf:type owl:Ontology ;
    # Description
    dcterms:title "Multi-User Domain Logic ontology" ;
    dcterms:description """
    Vocabulary defines Tasks and Actions conducted by agents in a game world.
    """ ;
    # Ownership
    dcterms:license <http://creativecommons.org/licenses/by/4.0/> ;
    dcterms:creator <https://calum.inrupt.net/profile/card#me> .

mudlogic:Action a rdfs:Class ;
    rdfs:subClassOf time:Instant ;
    rdfs:label "Action"@en ;
    rdfs:comment "An Instant Action - one which is completed by an Actor to achieve some end state"@en .

mudlogic:Task a rdfs:Class ;
    rdfs:subClassOf time:Interval ;
    rdfs:label "Task"@en ;
    rdfs:comment "An Interval which is being completed by an Actor to achieve some end state"@en .

mudlogic:Transit a mudlogic:Task ;
    rdfs:subclassOf mudlogic:Task ;
    rdfs:label "Transit Task"@en ;
    rdfs:comment "A Task which models the changing of location"@en .

mudlogic:Effect a rdfs:Class ;
    rdfs:subClassOf mudlogic:Action ;
    rdfs:label "Effect"@en ;
    rdfs:commnet "An effect is a type of action which is recurring (e.g. damage health from poison)"@en .

mudlogic:actAt a rdf:Property ;
    rdfs:label "actAt"@en ;
    rdfs:comment "The URL where the Action can be found"@en ;
    rdfs:domain mudlogic:Action, mudlogic:Task ;
    rdfs:range schema:URL .

mudlogic:parameterConstraintsShape a rdf:Property ;
    rdfs:label "Parameter Constraints Shape"@en ;
    rdfs:comment "A shape which is used for validating input parameters"@en ;
    rdfs:range sh:NodeShape .

mudlogic:recursAfterSeconds a rdf:Property ;
    rdfs:label "recursAfterSeconds"@en ;
    rdfs:comment "Indicates the number of seconds to wait before implementing the effect changes again"@en ;
    rdfs:domain mudlogic:Effect ;
    rdfs:range xsd:Integer .

mudlogic:expiresAfterOccurences a rdf:Property ;
    rdfs:label "expiresAfterOccurences"@en ;
    rdfs:comment "Indicates the number of occurences before the effect expires"@en ;
    rdfs:range xsd:Integer .

mudlogic:activeEffects a rdf:Property ;
    rdfs:label "activeEffects"@en ;
    rdfs:comment "An ldp:Container of the Effects which are actively recurring on the subject"@en ;
    rdfs:range ldp:Container .

# Bindings: Action parameters

mudlogic:ActionBinding a rdfs:Class ;
    rdfs:label "Action Binding"@en ;
    rdfs:comment "A resource which is bound to the input or output graph of an action"@en .

mudlogic:boundTo a rdf:Property ;
    rdfs:label "boundTo"@en ;
    rdfs:comment "The object indicates the object which is bound via the binding"@en ;
    rdfs:domain mudlogic:ActionBinding .

mudlogic:hasBinding a rdf:Property ;
    rdfs:label "hasBinding"@en ;
    rdfs:comment "Indicates that an action has a binding to a resource (i.e. a parameter, a resource which is involved in the action)"@en ;
    rdfs:range mudlogic:ActionBinding .

# TODO: instructing a game on how to find a binding using SPARQL
# (temporarily?) providing sub-types of ActionBinding for this purpose

mudlogic:ActorBinding a rdfs:Class ;
    rdfs:subClassOf mudlogic:ActionBinding ;
    rdfs:label "Actor Binding"@en ;
    rdfs:comment "The binding to the actor performing an action. Differentiated to aid a game in finding the right resource for the binding"@en .

mudlogic:TargetBinding a rdfs:Class ;
    rdfs:subClassOf mudlogic:ActionBinding ;
    rdfs:label "Target Binding"@en ;
    rdfs:comment "The binding to a target of a particular action. Differentiated to aid a game in finding the right resource for the binding"@en .

mudlogic:WitnessBinding a rdfs:Class ;
    rdfs:subClassOf mudlogic:ActionBinding ;
    rdfs:label "Witness Binding"@en ;
    rdfs:comment "The binding to a witness to the action performed. Differentiated to aid a game in finding the right resource for the binding"@en .

# modelling graph state changes made by an Action

mudlogic:Operation a rdfs:Class ;
    rdfs:label "Operation"@en ;
    rdfs:label "Operation"@fr ;
    rdfs:comment "Base class for different kinds of graph operation (e.g. Patch and Post)"@en .

mudlogic:Post a rdfs:Class ;
    rdfs:subClassOf mudlogic:Operation ;
    rdfs:label "Post"@en ;
    rdfs:comment "Attaches resources (via property inserts) to be created during a state change"@en .

mudlogic:Patch a rdfs:Class ;
    rdfs:subClassOf mudlogic:Operation ;
    rdfs:label "Patch"@en ;
    rdfs:comment "Attaches resources (via properties inserts and deletes) to be PATCHed during a state change. During a PATCH the referenced resources are not replaced"@en .

# TODO: formally add the constraints described in the property's description
mudlogic:taskImplements a rdf:Property ;
    rdfs:label "taskImplements"@en ;
    rdfs:comment "the Class (subclass of mudLogic:Task) which is implemented by this Task. Mandatory and can only have one value. See https://github.com/Multi-User-Domain/mud-jena/issues/25 for background"@en ;
    rdfs:domain mudlogic:Task ;
    rdfs:range rdfs:Class .

mudlogic:isComplete a rdf:Property ;
    rdfs:label "isComplete"@en ;
    rdfs:comment "If True, the task completion conditions have been met and the task has been completed"@en ;
    rdfs:domain mudlogic:Task ;
    rdfs:range xsd:boolean .

mudlogic:inserts a rdf:Property ;
    rdfs:label "Inserts"@en ;
    rdfs:comment "A pointer to (clone of a) Resource holding properties which should be inserted to a Graph during the change"@en ;
    rdfs:domain mudlogic:Operation ;
    rdfs:range ldp:Container .

mudlogic:deletes a rdf:Property ;
    rdfs:label "Deletes"@en ;
    rdfs:comment "A pointer to a (clone of a) Resource holding properties which should be deleted in a Graph during the change"@en ;
    rdfs:domain mudlogic:Operation ;
    rdfs:range ldp:Container .

mudlogic:postsOnComplete a rdf:Property ;
    rdfs:label "postsOnComplete"@en ;
    rdfs:comment "When an action or task is complete, the connected Post changes are made"@en ;
    rdfs:range mudlogic:Post .

mudlogic:patchesOnComplete a rdf:Property ;
    rdfs:label "patchesOnComplete"@en ;
    rdfs:comment "When an action or task is complete, the connected Patch changes are made"@en ;
    rdfs:range mudlogic:Patch .

mudlogic:actionDiscoveryEndpoint a rdf:Property ;
    rdfs:label "actionDiscoveryEndpoint"@en ;
    rdfs:comment "The URL where a supported action discovery endpoint can be found"@en ;
    rdfs:domain mud:Configuration ;
    rdfs:range schema:URL .

mudlogic:hasOngoingTask a rdf:Property ;
    rdfs:label "hasOngoingTask"@en ;
    rdfs:comment "a mudlogic:Task that a Thing is pre-occupied with" ;
    rdfs:range mudlogic:Task .
